# 테이블 구조화된 필드 템플릿
# 이 파일은 insert_structured_fields() 메서드 사용 시 참고용

# 작성자 정보
author_info:
  created_by: "사용자명"           # 작성자 이름

# 테이블 메타데이터
metadata:
  table_id: "TBL001"              # 표 고유 ID
  total_rows: 6                   # 전체 행 개수
  total_cols: 3                   # 전체 열 개수
  header_rows: 1                  # 헤더 행 개수
  footer_rows: 1                  # 푸터 행 개수
  body_rows: 4                    # 바디 행 개수 (자동 계산: total - header - footer)

# 헤더 영역 (0행 ~ header_rows-1)
# 필드명 형식: {TABLE_ID}_HEADER_{로컬행}_{열}
header:
  "(0, 0)":
    field_name: "TBL001_HEADER_0_0"
    section: "header"
    global_pos: [0, 0]            # 전체 표에서의 위치 (행, 열)
    local_pos: [0, 0]             # 헤더 내에서의 위치 (행, 열)
    total_size: [6, 3]            # 전체 표 크기
    merge_info:                   # 병합 정보 (인접 셀만)
      is_merged: true
      merged_right: true          # 오른쪽 셀과 병합됨
      merged_down: false          # 아래 셀과 병합 안 됨
    memo: "Table:TBL001 | Section:header | Position:(0/6,0/3) | LocalPos:(0,0) | Merged:→(0,1)"

  "(0, 1)":
    field_name: "TBL001_HEADER_0_1"
    section: "header"
    global_pos: [0, 1]
    local_pos: [0, 1]
    total_size: [6, 3]
    merge_info:
      is_merged: false            # 병합 안 됨
      merged_right: false
      merged_down: false
    memo: "Table:TBL001 | Section:header | Position:(0/6,1/3) | LocalPos:(0,1)"

  "(0, 2)":
    field_name: "TBL001_HEADER_0_2"
    section: "header"
    global_pos: [0, 2]
    local_pos: [0, 2]
    total_size: [6, 3]
    merge_info:
      is_merged: true
      merged_right: false
      merged_down: true           # 아래 셀과 병합됨
    memo: "Table:TBL001 | Section:header | Position:(0/6,2/3) | LocalPos:(0,2) | Merged:↓(1,2)"

# 바디 영역 (header_rows ~ total_rows-footer_rows-1)
# 필드명 형식: {TABLE_ID}_BODY_{로컬행}_{열}
body:
  "(1, 0)":
    field_name: "TBL001_BODY_0_0"
    section: "body"
    global_pos: [1, 0]            # 전체 표에서는 1행
    local_pos: [0, 0]             # 바디에서는 0행
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:body | Position:(1/6,0/3) | LocalPos:(0,0)"

  "(1, 1)":
    field_name: "TBL001_BODY_0_1"
    section: "body"
    global_pos: [1, 1]
    local_pos: [0, 1]
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:body | Position:(1/6,1/3) | LocalPos:(0,1)"

  "(1, 2)":
    field_name: "TBL001_BODY_0_2"
    section: "body"
    global_pos: [1, 2]
    local_pos: [0, 2]
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:body | Position:(1/6,2/3) | LocalPos:(0,2)"

  "(2, 0)":
    field_name: "TBL001_BODY_1_0"
    section: "body"
    global_pos: [2, 0]
    local_pos: [1, 0]
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:body | Position:(2/6,0/3) | LocalPos:(1,0)"

  "(2, 1)":
    field_name: "TBL001_BODY_1_1"
    section: "body"
    global_pos: [2, 1]
    local_pos: [1, 1]
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:body | Position:(2/6,1/3) | LocalPos:(1,1)"

  "(2, 2)":
    field_name: "TBL001_BODY_1_2"
    section: "body"
    global_pos: [2, 2]
    local_pos: [1, 2]
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:body | Position:(2/6,2/3) | LocalPos:(1,2)"

  # ... 나머지 바디 행 생략 (3행, 4행)

# 푸터 영역 (total_rows-footer_rows ~ total_rows-1)
# 필드명 형식: {TABLE_ID}_FOOTER_{로컬행}_{열}
footer:
  "(5, 0)":
    field_name: "TBL001_FOOTER_0_0"
    section: "footer"
    global_pos: [5, 0]            # 전체 표에서는 5행
    local_pos: [0, 0]             # 푸터에서는 0행
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:footer | Position:(5/6,0/3) | LocalPos:(0,0)"

  "(5, 1)":
    field_name: "TBL001_FOOTER_0_1"
    section: "footer"
    global_pos: [5, 1]
    local_pos: [0, 1]
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:footer | Position:(5/6,1/3) | LocalPos:(0,1)"

  "(5, 2)":
    field_name: "TBL001_FOOTER_0_2"
    section: "footer"
    global_pos: [5, 2]
    local_pos: [0, 2]
    total_size: [6, 3]
    memo: "Table:TBL001 | Section:footer | Position:(5/6,2/3) | LocalPos:(0,2)"

# 사용 예시:
# from table_manager import TableManager
# from cursor_utils import get_hwp_instance
#
# hwp = get_hwp_instance()
# manager = TableManager(hwp)
# table_ctrl = manager.get_table_by_index(0)
#
# result = manager.insert_structured_fields(
#     table_ctrl,
#     table_id="EMPLOYEE_TABLE",
#     header_rows=1,
#     footer_rows=1
# )
#
# # 결과는 위와 같은 구조로 반환되며 자동으로 YAML 저장됨

# 필드 정보 설명:
# - field_name: 필드의 고유 이름 (HWP 문서에 삽입됨)
# - section: 셀이 속한 영역 (header/body/footer)
# - global_pos: 전체 표 기준 (행, 열) 위치
# - local_pos: 해당 섹션 내에서의 (행, 열) 위치
# - total_size: 전체 표의 (행, 열) 크기
# - merge_info: 셀 병합 정보 (인접 셀만 표시)
#   - is_merged: 병합 여부 (bool)
#   - merged_right: 오른쪽 셀과 병합 여부
#   - merged_down: 아래 셀과 병합 여부
#   * 주의: 3개 이상 연결된 경우도 인접 셀 정보만 표시
#   * 예: (0,0)-(0,1)-(0,2) 병합 시
#     - (0,0): merged_right=True (→(0,1))
#     - (0,1): 정보 없음 (같은 셀로 간주됨)
#     - (0,2): 정보 없음 (같은 셀로 간주됨)
# - memo: 필드의 상세 정보 (HWP 필드 속성의 memo에 저장됨)
#   * 병합된 경우 "Merged:→(행,열),↓(행,열)" 형식으로 포함

# 활용 사례:
# 1. 데이터 테이블: header=컬럼명, body=데이터, footer=합계
# 2. 계약서: header=제목, body=조항, footer=서명란
# 3. 급여명세서: header=직원정보, body=급여항목, footer=총액
