# 한글 HWP 문단 위치 확인 방법

## 핵심 메서드

| 메서드 | 설명 |
|--------|------|
| `GetPos()` | 현재 커서 위치 반환 (list, para, pos) |
| `SetPos(list, para, pos)` | 특정 위치로 커서 이동 |
| `SetPosBySet(posObj)` | 파라미터셋으로 위치 이동 (더 간편) |

## 파라미터 의미

| 파라미터 | 의미 | 설명 |
|----------|------|------|
| **list** | 리스트 ID | 문서 내 영역 구분. 본문=0, 표/각주/글상자 등은 각각 다른 값 |
| **para** | 문단 ID | 문단 번호 (0부터 시작). Enter 키로 구분되는 단위 |
| **pos** | 글자 위치 | 문단 내에서 몇 번째 글자인지 (0부터 시작) |

### 쉽게 설명하면:

- **list**: "어느 영역에 있나?" (본문, 표 안, 각주, 글상자 등)
- **para**: "몇 번째 문단인가?" (Enter로 구분되는 덩어리)
- **pos**: "그 문단에서 몇 번째 글자인가?"

### 예시

```
"안녕하세요"  ← Para=0, Pos=0~4 (5글자)
(빈 줄)      ← Para=1
"반갑습니다"  ← Para=2, Pos=0~4 (5글자)
```

`SetPos(0, 2, 3)` → 본문(list=0)의 3번째 문단(para=2)에서 4번째 글자(pos=3) 위치로 이동

## 주의: 빈 문단도 카운트됨

`BreakPara`를 두 번 실행하면 빈 문단이 생성되며, 이 빈 문단도 Para 번호를 차지합니다.

예시 (문단 사이에 빈 줄이 있는 경우):
| Para | 내용 |
|------|------|
| 0 | 첫 번째 문단 |
| 1 | (빈 줄) |
| 2 | 두 번째 문단 |
| 3 | (빈 줄) |
| 4 | 세 번째 문단 |

빈 줄 없이 문단을 구분하려면 `BreakPara`를 한 번만 실행하세요.

## 실제 사용 예제

```python
import pythoncom
import win32com.client as win32

# ROT를 통해 기존 한글 인스턴스에 연결
context = pythoncom.CreateBindCtx(0)
rot = pythoncom.GetRunningObjectTable()

hwp = None
for moniker in rot:
    name = moniker.GetDisplayName(context, None)
    if 'HwpObject' in name:
        obj = rot.GetObject(moniker)
        hwp = win32.Dispatch(obj.QueryInterface(pythoncom.IID_IDispatch))
        break

# 현재 위치 확인
pos = hwp.GetPos()
print(f"List={pos[0]}, Para={pos[1]}, Pos={pos[2]}")

# 특정 문단으로 이동
hwp.SetPos(0, 2, 0)  # 3번째 문단(Para=2)의 시작으로 이동

# 문서 끝 위치 저장 후 탐색
hwp.HAction.Run("MoveDocEnd")
end_pos = hwp.GetPos()
hwp.HAction.Run("MoveDocBegin")

# 본문 외 영역(표, 글상자 등) 탐색
area = 1
while True:
    area += 1
    hwp.SetPos(area, 0, 0)
    if hwp.GetPos()[0] == 0:  # 본문으로 돌아오면 종료
        break
```

## 모든 문단 위치 확인

```python
# 문서 처음으로
hwp.HAction.Run('MoveDocBegin')

para_num = 0
while True:
    pos = hwp.GetPos()
    print(f'문단 {para_num}: List={pos[0]}, Para={pos[1]}, Pos={pos[2]}')

    old_pos = pos
    hwp.HAction.Run('MoveNextParaBegin')
    new_pos = hwp.GetPos()

    if old_pos[1] == new_pos[1]:  # 더 이상 이동 안 되면 종료
        break
    para_num += 1
```

## 참고 자료

- [한컴디벨로퍼 SetPos 공식 문서](https://developer.hancom.com/webhwp/devguide/hwpctrl/methods/setpos)
- [SetPosBySet 활용법 - martinii.fun](https://martinii.fun/255)
- [pyhwpx Cookbook - WikiDocs](https://wikidocs.net/book/8956)
